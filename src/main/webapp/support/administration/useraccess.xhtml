<ui:composition template="/WEB-INF/template2.xhtml"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:p="http://primefaces.org/ui">

  <ui:define name="meta">
    <h:outputStylesheet library="css" name="bootstrap-switch.min.css"></h:outputStylesheet>
  </ui:define>
  <ui:define name="header"></ui:define>
  <ui:define name="page">
    <div class="clearfix"></div>
    <div class="row">
      <div class="col-lg-12">
        <h:form>
          <ul class="nav nav-pills">
            <li><p:commandLink action="#{userAccessBean.save()}"
                styleClass="btn btn-default navbar-btn" value="Zapisz"
                ajax="false" validateClient="true"></p:commandLink></li>
            <li><p:link outcome="/support/administration/users.jsf"
                value="Anuluj" styleClass="btn btn-default navbar-btn">
              </p:link></li>
          </ul>
          <div class="row">
            <div class="col-sm-12">
              <p:messages styleClass="help-block"></p:messages>
              <div class="form-horizontal">
                <h2 class="page-header col-sm-2 col-sm-offset-4">Odczyt</h2>
                <h2 class="page-header col-sm-2">Edycja</h2>
                <div class="clearfix" />
                <ui:repeat var="form"
                  value="#{userAccessBean.userAccessModel.forms}"
                  varStatus="status">
                  <div class="form-group #{form.key}">
                    <p:outputLabel value="#{form.name}"
                      styleClass="control-label col-sm-4"></p:outputLabel>
                    <div class="col-sm-2">
                      <h:selectBooleanCheckbox
                        readonly="#{userAccessBean.disabled}"
                        value="#{userAccessBean.userAccessModel.readRights[status.index]}"
                        styleClass="toogle-switch read #{form.key}">
                      </h:selectBooleanCheckbox>
                    </div>
                    <div class="col-sm-2">
                      <h:selectBooleanCheckbox
                        readonly="#{userAccessBean.disabled}"
                        value="#{userAccessBean.userAccessModel.writeRights[status.index]}"
                        styleClass="toogle-switch write #{form.key}">
                      </h:selectBooleanCheckbox>
                    </div>
                  </div>
                </ui:repeat>



              </div>
              <!--/.form-horizontal  -->
            </div>
          </div>
        </h:form>
      </div>
      <!-- /.col-lg-12 (nested) -->
    </div>
    <!-- /.row -->

  </ui:define>
  <ui:define name="footer-meta">
    <h:outputScript library="js" name="bootstrap-switch.min.js"></h:outputScript>
    <script type="text/javascript">
    $(".toogle-switch").bootstrapSwitch({onColor: 'success', offColor: 'danger'});
    $('.toogle-switch.write').on('switchChange.bootstrapSwitch', function(event, state) {
        if (state) {
        	 var key = $(this).prop("class")
        	.replace('toogle-switch','')
        	.replace('write','')
        	.replace(/(\s)/g,'');
        	$('div.'+key).find('.read').bootstrapSwitch('state', true);
        }
    });
    $('.toogle-switch.read').on('switchChange.bootstrapSwitch', function(event, state) {
        if (!state) {
        	 var key = $(this).prop("class")
        	.replace('toogle-switch','')
        	.replace('read','')
        	.replace(/(\s)/g,'');
        	$('div.'+key).find('.write').bootstrapSwitch('state', false);
        }
    });
    </script>
  </ui:define>
</ui:composition>
